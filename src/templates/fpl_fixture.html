"% include 'header.html' %"

<main class="pt-3" :class="{'container-fluid': fill_width, 'container': !fill_width}" v-cloak>

    <div class="row" v-cloak id="fixture-main">
        <div class="col-12 mb-3">
            <div class="card card-field border-dark bg-squad-card text-white">
                <h5 class="card-header border-complement text-center scenario_title">FPL Fixture</h5>
                <div class="scenario_detail">
                    A detailed table of all FPL Gameweeks
                </div>
                <div class="card-body pl-0 pr-0">
                    <div class="d-flex flex-wrap justify-content-center mb-3">
                        <div class="flex-column metric mw-10 ml-1">
                            <div class="text-center p-0">Data Source</div>
                            <div class="setting-value text-center p-0">
                                <div class="d-flex flex-row setting-line mb-0">
                                    <select class="form-control live-select" id="data-source-select" v-model="option_data_source" @change="invalidate_cache">
                                        <option v-for="(i, id) in choice_data_source" :value="id">{{ i.name }}</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="flex-column metric mw-10 ml-1">
                            <div class="text-center p-0">Values</div>
                            <div class="setting-value text-center p-0">
                                <div class="d-flex flex-row setting-line mb-0">
                                    <select class="form-control live-select" id="data-type-select" v-model="option_data_type" @change="invalidate_cache">
                                        <option v-for="(i, id) in choice_data_type" :value="id">{{ i }}</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="flex-column metric mw-10 ml-1">
                            <div class="text-center p-0">Show</div>
                            <div class="setting-value text-center p-0">
                                <div class="d-flex flex-row setting-line mb-0">
                                    <select class="form-control live-select" id="data-type-select" v-model="option_table_display" @change="invalidate_cache">
                                        <option v-for="(i, id) in choice_table_display" :value="id">{{ i }}</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="flex-column metric mw-10 ml-1">
                            <div class="text-center p-0">DGW Order</div>
                            <div class="setting-value text-center p-0">
                                <div class="d-flex flex-row setting-line mb-0">
                                    <select class="form-control live-select" id="data-type-select" v-model="option_mgw_value" @change="invalidate_cache">
                                        <option v-for="(i, id) in choice_mgw_value" :value="id">{{ i[0] }}</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="flex-column metric mw-10 ml-1">
                            <div class="text-center p-0">Highlight DGW</div>
                            <div class="setting-value text-center p-0">
                                <div class="d-flex flex-row setting-line mb-0">
                                    <select class="form-control live-select" id="data-type-select" v-model="option_show_double" @change="invalidate_cache">
                                        <option :value="true">On</option>
                                        <option :value="false">Off</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="flex-column metric mw-10 ml-1 d-none d-md-block">
                            <div class="text-center p-0">Fill Width</div>
                            <div class="setting-value text-center p-0">
                                <div class="d-flex flex-row setting-line mb-0">
                                    <select class="form-control live-select" id="data-type-select" v-model="fill_width" @change="invalidate_cache">
                                        <option :value="true">On</option>
                                        <option :value="false">Off</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div>
                        <table class="table table-striped table-sm text-small text-white table-responsive" id="main_fixture" v-if="is_fixture_ready && is_main_ready">
                            <thead>
                                <tr>
                                    <th>Team</th>
                                    <th v-for="gw in gameweeks" :id="gw.this_gw ? 'active_gw' : 'col_gw' + gw.no" :class="{'active_gw_col': gw.this_gw}">{{ gw.text }}</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(t,id) in teams">
                                    <td :data-order="id">{{ t.name }}</td>
                                    <td v-for="gw in gameweeks" :class="{'active_gw_col': gw.this_gw, 'multi-gw': rivals[id+1][gw.no].length > 1 && option_show_double}" :data-order="order_value(rivals[id+1][gw.no])" :style="{'background': get_color(rivals[id+1][gw.no]) }">
                                        {{ option_table_display == 0 ? rivals[id+1][gw.no].map(j => j.rival).join(' + ') : order_value(rivals[id+1][gw.no], true) }}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="text-center d-block mx-auto" id="loading_box" v-else>
                            Loading data... Please wait...
                            <img class="mx-auto d-block" src="static/images/loading.svg">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- <div class="row" v-cloak>
        <div class="col-12 mb-3">
            <div class="card border-dark bg-squad-card text-white qa">
                <div class="card-body text-left">
                    <h5>Q/A</h5>
                    <b>Q?</b>
                    <p class="answer">A</p>
                </div>
                <div class="card-footer text-white disclaimer">
                    The information contained on this website is for general information purposes only. Any reliance you place on this information is strictly at your own risk.
                </div>
            </div>
        </div>
    </div> -->

</main>

<div class="modal" tabindex="-1" role="dialog" id="waitModal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Fetching data...</h5>
            </div>
            <div class="modal-body">
                <div class="p-2 wait-modal">
                    Fetching data and updating visuals. Please wait... <br/>
                    <img class="mx-auto d-block" src="static/images/loading.svg">
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let data_target = "** data_target **";
</script>

"% with scripts=["main", "sampling_utils", "fpl_fixture"] %" "% include 'footer.html' %" "% endwith %"